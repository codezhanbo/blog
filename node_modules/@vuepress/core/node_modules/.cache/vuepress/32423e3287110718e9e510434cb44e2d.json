{"remainingRequest":"C:\\Users\\zhanb\\Desktop\\vuepress-theme-reco\\my-blog\\node_modules\\babel-loader\\lib\\index.js??ref--3-1!C:\\Users\\zhanb\\Desktop\\vuepress-theme-reco\\my-blog\\node_modules\\@vssue\\api-gitlab-v4\\lib\\index.js","dependencies":[{"path":"C:\\Users\\zhanb\\Desktop\\vuepress-theme-reco\\my-blog\\node_modules\\@vssue\\api-gitlab-v4\\lib\\index.js","mtime":1589019268180},{"path":"C:\\Users\\zhanb\\Desktop\\vuepress-theme-reco\\my-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1588985061160},{"path":"C:\\Users\\zhanb\\Desktop\\vuepress-theme-reco\\my-blog\\node_modules\\babel-loader\\lib\\index.js","mtime":1588985061023}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvcnQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc2VhcmNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciI7CmltcG9ydCBfc2xpY2VkVG9BcnJheSBmcm9tICJDOi9Vc2Vycy96aGFuYi9EZXNrdG9wL3Z1ZXByZXNzLXRoZW1lLXJlY28vbXktYmxvZy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7CmltcG9ydCBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciBmcm9tICJDOi9Vc2Vycy96aGFuYi9EZXNrdG9wL3Z1ZXByZXNzLXRoZW1lLXJlY28vbXktYmxvZy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6L1VzZXJzL3poYW5iL0Rlc2t0b3AvdnVlcHJlc3MtdGhlbWUtcmVjby9teS1ibG9nL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOi9Vc2Vycy96aGFuYi9EZXNrdG9wL3Z1ZXByZXNzLXRoZW1lLXJlY28vbXktYmxvZy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkM6L1VzZXJzL3poYW5iL0Rlc2t0b3AvdnVlcHJlc3MtdGhlbWUtcmVjby9teS1ibG9nL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCB7IGJ1aWxkUXVlcnksIGJ1aWxkVVJMLCBjb25jYXRVUkwsIGdldENsZWFuVVJMLCBwYXJzZVF1ZXJ5IH0gZnJvbSAnQHZzc3VlL3V0aWxzJzsKaW1wb3J0IHsgbm9ybWFsaXplVXNlciwgbm9ybWFsaXplSXNzdWUsIG5vcm1hbGl6ZUNvbW1lbnQsIG5vcm1hbGl6ZVJlYWN0aW9ucywgbWFwUmVhY3Rpb25OYW1lIH0gZnJvbSAnLi91dGlscyc7Ci8qKgogKiBHaXRMYWIgQVBJIFY0CiAqCiAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpLwogKiBAc2VlIGh0dHBzOi8vZG9jcy5naXRsYWIuY29tL2NlL2FwaS9vYXV0aDIuaHRtbAogKi8KCnZhciBHaXRsYWJWNCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gR2l0bGFiVjQoX3JlZikgewogICAgdmFyIF9yZWYkYmFzZVVSTCA9IF9yZWYuYmFzZVVSTCwKICAgICAgICBiYXNlVVJMID0gX3JlZiRiYXNlVVJMID09PSB2b2lkIDAgPyAnaHR0cHM6Ly9naXRsYWIuY29tJyA6IF9yZWYkYmFzZVVSTCwKICAgICAgICBvd25lciA9IF9yZWYub3duZXIsCiAgICAgICAgcmVwbyA9IF9yZWYucmVwbywKICAgICAgICBsYWJlbHMgPSBfcmVmLmxhYmVscywKICAgICAgICBjbGllbnRJZCA9IF9yZWYuY2xpZW50SWQsCiAgICAgICAgc3RhdGUgPSBfcmVmLnN0YXRlOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBHaXRsYWJWNCk7CgogICAgdGhpcy5iYXNlVVJMID0gYmFzZVVSTDsKICAgIHRoaXMub3duZXIgPSBvd25lcjsKICAgIHRoaXMucmVwbyA9IHJlcG87CiAgICB0aGlzLmxhYmVscyA9IGxhYmVsczsKICAgIHRoaXMuY2xpZW50SWQgPSBjbGllbnRJZDsKICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTsgLy8gQHNlZSBodHRwczovL2RvY3MuZ2l0bGFiLmNvbS9jZS9hcGkvUkVBRE1FLmh0bWwjbmFtZXNwYWNlZC1wYXRoLWVuY29kaW5nCgogICAgdGhpcy5fZW5jb2RlZFJlcG8gPSBlbmNvZGVVUklDb21wb25lbnQoIiIuY29uY2F0KHRoaXMub3duZXIsICIvIikuY29uY2F0KHRoaXMucmVwbykpOwogICAgdGhpcy4kaHR0cCA9IGF4aW9zLmNyZWF0ZSh7CiAgICAgIGJhc2VVUkw6IGNvbmNhdFVSTChiYXNlVVJMLCAnYXBpL3Y0JyksCiAgICAgIGhlYWRlcnM6IHsKICAgICAgICBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICB9CiAgICB9KTsKICB9CiAgLyoqCiAgICogVGhlIHBsYXRmb3JtIGFwaSBpbmZvCiAgICovCgoKICBfY3JlYXRlQ2xhc3MoR2l0bGFiVjQsIFt7CiAgICBrZXk6ICJyZWRpcmVjdEF1dGgiLAoKICAgIC8qKgogICAgICogUmVkaXJlY3QgdG8gdGhlIGF1dGhvcml6YXRpb24gcGFnZSBvZiBwbGF0Zm9ybS4KICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5naXRsYWIuY29tL2NlL2FwaS9vYXV0aDIuaHRtbCMxLXJlcXVlc3RpbmctYXV0aG9yaXphdGlvbi1jb2RlCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiByZWRpcmVjdEF1dGgoKSB7CiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gYnVpbGRVUkwoY29uY2F0VVJMKHRoaXMuYmFzZVVSTCwgJ29hdXRoL2F1dGhvcml6ZScpLCB7CiAgICAgICAgY2xpZW50X2lkOiB0aGlzLmNsaWVudElkLAogICAgICAgIHJlZGlyZWN0X3VyaTogd2luZG93LmxvY2F0aW9uLmhyZWYsCiAgICAgICAgcmVzcG9uc2VfdHlwZTogJ3Rva2VuJywKICAgICAgICBzdGF0ZTogdGhpcy5zdGF0ZQogICAgICB9KTsKICAgIH0KICAgIC8qKgogICAgICogSGFuZGxlIGF1dGhvcml6YXRpb24uCiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RvY3MuZ2l0bGFiLmNvbS9jZS9hcGkvb2F1dGgyLmh0bWwjaW1wbGljaXQtZ3JhbnQtZmxvdwogICAgICoKICAgICAqIEByZW1hcmtzCiAgICAgKiBJZiB0aGUgYGFjY2Vzc190b2tlbmAgYW5kIGBzdGF0ZWAgZXhpc3QgaW4gdGhlIHF1ZXJ5LCBhbmQgdGhlIGBzdGF0ZWAgbWF0Y2hlcywgcmVtb3ZlIHRoZW0gZnJvbSBxdWVyeSwgYW5kIHJldHVybiB0aGUgYWNjZXNzIHRva2VuLgogICAgICovCgogIH0sIHsKICAgIGtleTogImhhbmRsZUF1dGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9oYW5kbGVBdXRoID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBoYXNoLCBhY2Nlc3NUb2tlbiwgaGFzaFN0cmluZywgbmV3SGFzaCwgcmVwbGFjZVVSTDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBoYXNoID0gcGFyc2VRdWVyeSh3aW5kb3cubG9jYXRpb24uaGFzaC5zbGljZSgxKSk7CgogICAgICAgICAgICAgICAgaWYgKCEoIWhhc2guYWNjZXNzX3Rva2VuIHx8IGhhc2guc3RhdGUgIT09IHRoaXMuc3RhdGUpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBudWxsKTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBoYXNoLmFjY2Vzc190b2tlbjsKICAgICAgICAgICAgICAgIGRlbGV0ZSBoYXNoLmFjY2Vzc190b2tlbjsKICAgICAgICAgICAgICAgIGRlbGV0ZSBoYXNoLnRva2VuX3R5cGU7CiAgICAgICAgICAgICAgICBkZWxldGUgaGFzaC5leHBpcmVzX2luOwogICAgICAgICAgICAgICAgZGVsZXRlIGhhc2guc3RhdGU7CiAgICAgICAgICAgICAgICBoYXNoU3RyaW5nID0gYnVpbGRRdWVyeShoYXNoKTsKICAgICAgICAgICAgICAgIG5ld0hhc2ggPSBoYXNoU3RyaW5nID8gIiMiLmNvbmNhdChoYXNoU3RyaW5nKSA6ICcnOwogICAgICAgICAgICAgICAgcmVwbGFjZVVSTCA9ICIiLmNvbmNhdChnZXRDbGVhblVSTCh3aW5kb3cubG9jYXRpb24uaHJlZikpLmNvbmNhdCh3aW5kb3cubG9jYXRpb24uc2VhcmNoKS5jb25jYXQobmV3SGFzaCk7CiAgICAgICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5yZXBsYWNlU3RhdGUobnVsbCwgJycsIHJlcGxhY2VVUkwpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgYWNjZXNzVG9rZW4pOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGhhbmRsZUF1dGgoKSB7CiAgICAgICAgcmV0dXJuIF9oYW5kbGVBdXRoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBoYW5kbGVBdXRoOwogICAgfSgpCiAgICAvKioKICAgICAqIEdldCB0aGUgbG9nZ2VkLWluIHVzZXIgd2l0aCBhY2Nlc3MgdG9rZW4uCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0VXNlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldFVzZXIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKF9yZWYyKSB7CiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuLCBfeWllbGQkdGhpcyQkaHR0cCRnZXQsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWYyLmFjY2Vzc1Rva2VuOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAuZ2V0KCd1c2VyJywgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJGdldCA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJGdldC5kYXRhOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIG5vcm1hbGl6ZVVzZXIoZGF0YSkpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRVc2VyKF94KSB7CiAgICAgICAgcmV0dXJuIF9nZXRVc2VyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRVc2VyOwogICAgfSgpCiAgICAvKioKICAgICAqIEdldCBpc3N1ZSBvZiB0aGlzIHBhZ2UgYWNjb3JkaW5nIHRvIHRoZSBpc3N1ZSBpZCBvciB0aGUgaXNzdWUgdGl0bGUKICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5naXRsYWIuY29tL2NlL2FwaS9pc3N1ZXMuaHRtbCNzaW5nbGUtaXNzdWUKICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpL2lzc3Vlcy5odG1sI2xpc3QtaXNzdWVzCiAgICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5naXRsYWIuY29tL2NlL2FwaS9SRUFETUUuaHRtbCNwYWdpbmF0aW9uCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0SXNzdWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRJc3N1ZSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoX3JlZjMpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGlzc3VlSWQsIGlzc3VlVGl0bGUsIG9wdGlvbnMsIF95aWVsZCR0aGlzJCRodHRwJGdldDIsIGRhdGEsIF95aWVsZCR0aGlzJCRodHRwJGdldDMsIF9kYXRhLCBpc3N1ZTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjMuYWNjZXNzVG9rZW4sIGlzc3VlSWQgPSBfcmVmMy5pc3N1ZUlkLCBpc3N1ZVRpdGxlID0gX3JlZjMuaXNzdWVUaXRsZTsKICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7fTsKCiAgICAgICAgICAgICAgICBpZiAoYWNjZXNzVG9rZW4pIHsKICAgICAgICAgICAgICAgICAgb3B0aW9ucy5oZWFkZXJzID0gewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCFpc3N1ZUlkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5wcmV2ID0gNDsKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLmdldCgicHJvamVjdHMvIi5jb25jYXQodGhpcy5fZW5jb2RlZFJlcG8sICIvaXNzdWVzLyIpLmNvbmNhdChpc3N1ZUlkKSwgb3B0aW9ucyk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJGdldDIgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRnZXQyLmRhdGE7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgbm9ybWFsaXplSXNzdWUoZGF0YSkpOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgX2NvbnRleHQzLnByZXYgPSAxMjsKICAgICAgICAgICAgICAgIF9jb250ZXh0My50MCA9IF9jb250ZXh0M1siY2F0Y2giXSg0KTsKCiAgICAgICAgICAgICAgICBpZiAoIShfY29udGV4dDMudDAucmVzcG9uc2UgJiYgX2NvbnRleHQzLnQwLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDA0KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgbnVsbCk7CgogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgICB0aHJvdyBfY29udGV4dDMudDA7CgogICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI4OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICBvcHRpb25zLnBhcmFtcyA9IHsKICAgICAgICAgICAgICAgICAgbGFiZWxzOiB0aGlzLmxhYmVscy5qb2luKCcsJyksCiAgICAgICAgICAgICAgICAgIG9yZGVyX2J5OiAnY3JlYXRlZF9hdCcsCiAgICAgICAgICAgICAgICAgIHNvcnQ6ICdhc2MnLAogICAgICAgICAgICAgICAgICBzZWFyY2g6IGlzc3VlVGl0bGUKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI0OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGh0dHAuZ2V0KCJwcm9qZWN0cy8iLmNvbmNhdCh0aGlzLl9lbmNvZGVkUmVwbywgIi9pc3N1ZXMiKSwgb3B0aW9ucyk7CgogICAgICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRnZXQzID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgICBfZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJGdldDMuZGF0YTsKICAgICAgICAgICAgICAgIGlzc3VlID0gX2RhdGEubWFwKG5vcm1hbGl6ZUlzc3VlKS5maW5kKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnRpdGxlID09PSBpc3N1ZVRpdGxlOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgaXNzdWUgfHwgbnVsbCk7CgogICAgICAgICAgICAgIGNhc2UgMjg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMsIHRoaXMsIFtbNCwgMTJdXSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldElzc3VlKF94MikgewogICAgICAgIHJldHVybiBfZ2V0SXNzdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldElzc3VlOwogICAgfSgpCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBpc3N1ZQogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpL2lzc3Vlcy5odG1sI25ldy1pc3N1ZQogICAgICovCgogIH0sIHsKICAgIGtleTogInBvc3RJc3N1ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3Bvc3RJc3N1ZSA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoX3JlZjQpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIHRpdGxlLCBjb250ZW50LCBfeWllbGQkdGhpcyQkaHR0cCRwb3MsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWY0LmFjY2Vzc1Rva2VuLCB0aXRsZSA9IF9yZWY0LnRpdGxlLCBjb250ZW50ID0gX3JlZjQuY29udGVudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoInByb2plY3RzLyIuY29uY2F0KHRoaXMuX2VuY29kZWRSZXBvLCAiL2lzc3VlcyIpLCB7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiB0aXRsZSwKICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IGNvbnRlbnQsCiAgICAgICAgICAgICAgICAgIGxhYmVsczogdGhpcy5sYWJlbHMuam9pbignLCcpCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KGFjY2Vzc1Rva2VuKQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgX3lpZWxkJHRoaXMkJGh0dHAkcG9zID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkcG9zLmRhdGE7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgbm9ybWFsaXplSXNzdWUoZGF0YSkpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBwb3N0SXNzdWUoX3gzKSB7CiAgICAgICAgcmV0dXJuIF9wb3N0SXNzdWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBvc3RJc3N1ZTsKICAgIH0oKQogICAgLyoqCiAgICAgKiBHZXQgY29tbWVudHMgb2YgdGhpcyBwYWdlIGFjY29yZGluZyB0byB0aGUgaXNzdWUgaWQKICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5naXRsYWIuY29tL2NlL2FwaS9ub3Rlcy5odG1sI2xpc3QtcHJvamVjdC1pc3N1ZS1ub3RlcwogICAgICogQHNlZSBodHRwczovL2RvY3MuZ2l0bGFiLmNvbS9jZS9hcGkvUkVBRE1FLmh0bWwjcGFnaW5hdGlvbgogICAgICoKICAgICAqIEByZW1hcmtzCiAgICAgKiBDYW5ub3QgZ2V0IHRoZSBIVE1MIGNvbnRlbnQgYW5kIHRoZSByZWFjdGlvbnMgKGF3YXJkX2Vtb2ppKSBoZXJlLgogICAgICogU28gaGF2ZSB0byByZXF1ZXN0IHRoZW0gdmlhIGBtYXJrZG93bmAgYW5kIGBhd2FyZF9lbW9qaWAgQVBJLgogICAgICovCgogIH0sIHsKICAgIGtleTogImdldENvbW1lbnRzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0Q29tbWVudHMgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU3KF9yZWY1KSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuLCBpc3N1ZUlkLCBfcmVmNSRxdWVyeSwgX3JlZjUkcXVlcnkkcGFnZSwgcGFnZSwgX3JlZjUkcXVlcnkkcGVyUGFnZSwgcGVyUGFnZSwgX3JlZjUkcXVlcnkkc29ydCwgc29ydCwgb3B0aW9ucywgcmVzcG9uc2UsIGNvbW1lbnRzUmF3LCBnZXRDb21tZW50c01ldGEsIF9pdGVyYXRvciwgX3N0ZXAsIF9sb29wOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTckKF9jb250ZXh0NykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDcucHJldiA9IF9jb250ZXh0Ny5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfcmVmNS5hY2Nlc3NUb2tlbiwgaXNzdWVJZCA9IF9yZWY1Lmlzc3VlSWQsIF9yZWY1JHF1ZXJ5ID0gX3JlZjUucXVlcnk7CiAgICAgICAgICAgICAgICBfcmVmNSRxdWVyeSA9IF9yZWY1JHF1ZXJ5ID09PSB2b2lkIDAgPyB7fSA6IF9yZWY1JHF1ZXJ5OwogICAgICAgICAgICAgICAgX3JlZjUkcXVlcnkkcGFnZSA9IF9yZWY1JHF1ZXJ5LnBhZ2UsIHBhZ2UgPSBfcmVmNSRxdWVyeSRwYWdlID09PSB2b2lkIDAgPyAxIDogX3JlZjUkcXVlcnkkcGFnZSwgX3JlZjUkcXVlcnkkcGVyUGFnZSA9IF9yZWY1JHF1ZXJ5LnBlclBhZ2UsIHBlclBhZ2UgPSBfcmVmNSRxdWVyeSRwZXJQYWdlID09PSB2b2lkIDAgPyAxMCA6IF9yZWY1JHF1ZXJ5JHBlclBhZ2UsIF9yZWY1JHF1ZXJ5JHNvcnQgPSBfcmVmNSRxdWVyeS5zb3J0LCBzb3J0ID0gX3JlZjUkcXVlcnkkc29ydCA9PT0gdm9pZCAwID8gJ2Rlc2MnIDogX3JlZjUkcXVlcnkkc29ydDsKICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7CiAgICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICAgIC8vIHBhZ2luYXRpb24KICAgICAgICAgICAgICAgICAgICBwYWdlOiBwYWdlLAogICAgICAgICAgICAgICAgICAgIHBlcl9wYWdlOiBwZXJQYWdlLAogICAgICAgICAgICAgICAgICAgIG9yZGVyX2J5OiAnY3JlYXRlZF9hdCcsCiAgICAgICAgICAgICAgICAgICAgc29ydDogc29ydAogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIGlmIChhY2Nlc3NUb2tlbikgewogICAgICAgICAgICAgICAgICBvcHRpb25zLmhlYWRlcnMgPSB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDc7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cC5nZXQoInByb2plY3RzLyIuY29uY2F0KHRoaXMuX2VuY29kZWRSZXBvLCAiL2lzc3Vlcy8iKS5jb25jYXQoaXNzdWVJZCwgIi9ub3RlcyIpLCBvcHRpb25zKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDcuc2VudDsKICAgICAgICAgICAgICAgIGNvbW1lbnRzUmF3ID0gcmVzcG9uc2UuZGF0YTsgLy8gZ2l0bGFiIGFwaSB2NCBzaG91bGQgZ2V0IHBhcnNlZCBtYXJrZG93biBjb250ZW50IGFuZCByZWFjdGlvbnMgYnkgb3RoZXIgYXBpCiAgICAgICAgICAgICAgICAvLyB0aGlzIGlzIHBvdGVudGlhbGx5IHRvIGNhdXNlIDQyOSBUb28gTWFueSBSZXF1ZXN0cwoKICAgICAgICAgICAgICAgIGdldENvbW1lbnRzTWV0YSA9IFtdOwogICAgICAgICAgICAgICAgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoY29tbWVudHNSYXcpOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbW1lbnQgPSBfc3RlcC52YWx1ZTsKICAgICAgICAgICAgICAgICAgICBnZXRDb21tZW50c01ldGEucHVzaChfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuZ2V0TWFya2Rvd25Db250ZW50KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbjogYWNjZXNzVG9rZW4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFJhdzogY29tbWVudC5ib2R5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tbWVudC5ib2R5X2h0bWwgPSBfY29udGV4dDUuc2VudDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgICAgICAgICAgICAgICB9KSkoKSk7CiAgICAgICAgICAgICAgICAgICAgZ2V0Q29tbWVudHNNZXRhLnB1c2goX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNiQoX2NvbnRleHQ2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmdldENvbW1lbnRSZWFjdGlvbnMoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhY2Nlc3NUb2tlbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc3N1ZUlkOiBpc3N1ZUlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnRJZDogY29tbWVudC5pZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1lbnQucmVhY3Rpb25zID0gX2NvbnRleHQ2LnNlbnQ7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9LCBfY2FsbGVlNik7CiAgICAgICAgICAgICAgICAgICAgfSkpKCkpOwogICAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgICAgICAgICBfbG9vcCgpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgIF9pdGVyYXRvci5mKCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChnZXRDb21tZW50c01ldGEpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIsIHsKICAgICAgICAgICAgICAgICAgY291bnQ6IE51bWJlcihyZXNwb25zZS5oZWFkZXJzWyd4LXRvdGFsJ10pLAogICAgICAgICAgICAgICAgICBwYWdlOiBOdW1iZXIocmVzcG9uc2UuaGVhZGVyc1sneC1wYWdlJ10pLAogICAgICAgICAgICAgICAgICBwZXJQYWdlOiBOdW1iZXIocmVzcG9uc2UuaGVhZGVyc1sneC1wZXItcGFnZSddKSwKICAgICAgICAgICAgICAgICAgZGF0YTogY29tbWVudHNSYXcubWFwKG5vcm1hbGl6ZUNvbW1lbnQpCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNywgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldENvbW1lbnRzKF94NCkgewogICAgICAgIHJldHVybiBfZ2V0Q29tbWVudHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldENvbW1lbnRzOwogICAgfSgpCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBjb21tZW50CiAgICAgKgogICAgICogQHNlZSBodHRwczovL2RvY3MuZ2l0bGFiLmNvbS9jZS9hcGkvbm90ZXMuaHRtbCNjcmVhdGUtbmV3LWlzc3VlLW5vdGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJwb3N0Q29tbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3Bvc3RDb21tZW50ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOChfcmVmOCkgewogICAgICAgIHZhciBhY2Nlc3NUb2tlbiwgaXNzdWVJZCwgY29udGVudCwgX3lpZWxkJHRoaXMkJGh0dHAkcG9zMiwgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gX3JlZjguYWNjZXNzVG9rZW4sIGlzc3VlSWQgPSBfcmVmOC5pc3N1ZUlkLCBjb250ZW50ID0gX3JlZjguY29udGVudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoInByb2plY3RzLyIuY29uY2F0KHRoaXMuX2VuY29kZWRSZXBvLCAiL2lzc3Vlcy8iKS5jb25jYXQoaXNzdWVJZCwgIi9ub3RlcyIpLCB7CiAgICAgICAgICAgICAgICAgIGJvZHk6IGNvbnRlbnQKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRwb3MyID0gX2NvbnRleHQ4LnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkcG9zMi5kYXRhOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoInJldHVybiIsIG5vcm1hbGl6ZUNvbW1lbnQoZGF0YSkpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTgsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBwb3N0Q29tbWVudChfeDUpIHsKICAgICAgICByZXR1cm4gX3Bvc3RDb21tZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwb3N0Q29tbWVudDsKICAgIH0oKQogICAgLyoqCiAgICAgKiBFZGl0IGEgY29tbWVudAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpL25vdGVzLmh0bWwjbW9kaWZ5LWV4aXN0aW5nLWlzc3VlLW5vdGUKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJwdXRDb21tZW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcHV0Q29tbWVudCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTkoX3JlZjkpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGlzc3VlSWQsIGNvbW1lbnRJZCwgY29udGVudCwgX3lpZWxkJHRoaXMkJGh0dHAkcHV0LCBkYXRhLCBfeWllbGQkUHJvbWlzZSRhbGwsIF95aWVsZCRQcm9taXNlJGFsbDIsIGNvbnRlbnRIVE1MLCByZWFjdGlvbnM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlOSQoX2NvbnRleHQ5KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0OS5wcmV2ID0gX2NvbnRleHQ5Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWY5LmFjY2Vzc1Rva2VuLCBpc3N1ZUlkID0gX3JlZjkuaXNzdWVJZCwgY29tbWVudElkID0gX3JlZjkuY29tbWVudElkLCBjb250ZW50ID0gX3JlZjkuY29udGVudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnB1dCgicHJvamVjdHMvIi5jb25jYXQodGhpcy5fZW5jb2RlZFJlcG8sICIvaXNzdWVzLyIpLmNvbmNhdChpc3N1ZUlkLCAiL25vdGVzLyIpLmNvbmNhdChjb21tZW50SWQpLCB7CiAgICAgICAgICAgICAgICAgIGJvZHk6IGNvbnRlbnQKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRwdXQgPSBfY29udGV4dDkuc2VudDsKICAgICAgICAgICAgICAgIGRhdGEgPSBfeWllbGQkdGhpcyQkaHR0cCRwdXQuZGF0YTsKICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRNYXJrZG93bkNvbnRlbnQoewogICAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbjogYWNjZXNzVG9rZW4sCiAgICAgICAgICAgICAgICAgIGNvbnRlbnRSYXc6IGRhdGEuYm9keQogICAgICAgICAgICAgICAgfSksIHRoaXMuZ2V0Q29tbWVudFJlYWN0aW9ucyh7CiAgICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhY2Nlc3NUb2tlbiwKICAgICAgICAgICAgICAgICAgaXNzdWVJZDogaXNzdWVJZCwKICAgICAgICAgICAgICAgICAgY29tbWVudElkOiBkYXRhLmlkCiAgICAgICAgICAgICAgICB9KV0pOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBfeWllbGQkUHJvbWlzZSRhbGwgPSBfY29udGV4dDkuc2VudDsKICAgICAgICAgICAgICAgIF95aWVsZCRQcm9taXNlJGFsbDIgPSBfc2xpY2VkVG9BcnJheShfeWllbGQkUHJvbWlzZSRhbGwsIDIpOwogICAgICAgICAgICAgICAgY29udGVudEhUTUwgPSBfeWllbGQkUHJvbWlzZSRhbGwyWzBdOwogICAgICAgICAgICAgICAgcmVhY3Rpb25zID0gX3lpZWxkJFByb21pc2UkYWxsMlsxXTsKICAgICAgICAgICAgICAgIGRhdGEuYm9keV9odG1sID0gY29udGVudEhUTUw7CiAgICAgICAgICAgICAgICBkYXRhLnJlYWN0aW9ucyA9IHJlYWN0aW9uczsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDkuYWJydXB0KCJyZXR1cm4iLCBub3JtYWxpemVDb21tZW50KGRhdGEpKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHB1dENvbW1lbnQoX3g2KSB7CiAgICAgICAgcmV0dXJuIF9wdXRDb21tZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBwdXRDb21tZW50OwogICAgfSgpCiAgICAvKioKICAgICAqIERlbGV0ZSBhIGNvbW1lbnQKICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5naXRsYWIuY29tL2NlL2FwaS9ub3Rlcy5odG1sI2RlbGV0ZS1hbi1pc3N1ZS1ub3RlCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZGVsZXRlQ29tbWVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2RlbGV0ZUNvbW1lbnQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMChfcmVmMTApIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGlzc3VlSWQsIGNvbW1lbnRJZCwgX3lpZWxkJHRoaXMkJGh0dHAkZGVsLCBzdGF0dXM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfcmVmMTAuYWNjZXNzVG9rZW4sIGlzc3VlSWQgPSBfcmVmMTAuaXNzdWVJZCwgY29tbWVudElkID0gX3JlZjEwLmNvbW1lbnRJZDsKICAgICAgICAgICAgICAgIF9jb250ZXh0MTAubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kaHR0cFsiZGVsZXRlIl0oInByb2plY3RzLyIuY29uY2F0KHRoaXMuX2VuY29kZWRSZXBvLCAiL2lzc3Vlcy8iKS5jb25jYXQoaXNzdWVJZCwgIi9ub3Rlcy8iKS5jb25jYXQoY29tbWVudElkKSwgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJGRlbCA9IF9jb250ZXh0MTAuc2VudDsKICAgICAgICAgICAgICAgIHN0YXR1cyA9IF95aWVsZCR0aGlzJCRodHRwJGRlbC5zdGF0dXM7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5hYnJ1cHQoInJldHVybiIsIHN0YXR1cyA9PT0gMjA0KTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTAsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBkZWxldGVDb21tZW50KF94NykgewogICAgICAgIHJldHVybiBfZGVsZXRlQ29tbWVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZGVsZXRlQ29tbWVudDsKICAgIH0oKQogICAgLyoqCiAgICAgKiBHZXQgcmVhY3Rpb25zIG9mIGEgY29tbWVudAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpL2F3YXJkX2Vtb2ppLmh0bWwjbGlzdC1hbi1hd2FyZGFibGVzLWF3YXJkLWVtb2ppCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0Q29tbWVudFJlYWN0aW9ucyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldENvbW1lbnRSZWFjdGlvbnMgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMShfcmVmMTEpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGlzc3VlSWQsIGNvbW1lbnRJZCwgX3lpZWxkJHRoaXMkJGh0dHAkZ2V0NCwgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMSQoX2NvbnRleHQxMSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDExLnByZXYgPSBfY29udGV4dDExLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IF9yZWYxMS5hY2Nlc3NUb2tlbiwgaXNzdWVJZCA9IF9yZWYxMS5pc3N1ZUlkLCBjb21tZW50SWQgPSBfcmVmMTEuY29tbWVudElkOwogICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLmdldCgicHJvamVjdHMvIi5jb25jYXQodGhpcy5fZW5jb2RlZFJlcG8sICIvaXNzdWVzLyIpLmNvbmNhdChpc3N1ZUlkLCAiL25vdGVzLyIpLmNvbmNhdChjb21tZW50SWQsICIvYXdhcmRfZW1vamkiKSwgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF95aWVsZCR0aGlzJCRodHRwJGdldDQgPSBfY29udGV4dDExLnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJHRoaXMkJGh0dHAkZ2V0NC5kYXRhOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuYWJydXB0KCJyZXR1cm4iLCBub3JtYWxpemVSZWFjdGlvbnMoZGF0YSkpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDExLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGdldENvbW1lbnRSZWFjdGlvbnMoX3g4KSB7CiAgICAgICAgcmV0dXJuIF9nZXRDb21tZW50UmVhY3Rpb25zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRDb21tZW50UmVhY3Rpb25zOwogICAgfSgpCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyByZWFjdGlvbiBvZiBhIGNvbW1lbnQKICAgICAqCiAgICAgKiBAc2VlIGh0dHBzOi8vZG9jcy5naXRsYWIuY29tL2NlL2FwaS9hd2FyZF9lbW9qaS5odG1sI2F3YXJkLWEtbmV3LWVtb2ppCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicG9zdENvbW1lbnRSZWFjdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3Bvc3RDb21tZW50UmVhY3Rpb24gPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMihfcmVmMTIpIHsKICAgICAgICB2YXIgaXNzdWVJZCwgY29tbWVudElkLCByZWFjdGlvbiwgYWNjZXNzVG9rZW4sIHJlc3BvbnNlOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTIkKF9jb250ZXh0MTIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMi5wcmV2ID0gX2NvbnRleHQxMi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaXNzdWVJZCA9IF9yZWYxMi5pc3N1ZUlkLCBjb21tZW50SWQgPSBfcmVmMTIuY29tbWVudElkLCByZWFjdGlvbiA9IF9yZWYxMi5yZWFjdGlvbiwgYWNjZXNzVG9rZW4gPSBfcmVmMTIuYWNjZXNzVG9rZW47CiAgICAgICAgICAgICAgICBfY29udGV4dDEyLnByZXYgPSAxOwogICAgICAgICAgICAgICAgX2NvbnRleHQxMi5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoInByb2plY3RzLyIuY29uY2F0KHRoaXMuX2VuY29kZWRSZXBvLCAiL2lzc3Vlcy8iKS5jb25jYXQoaXNzdWVJZCwgIi9ub3Rlcy8iKS5jb25jYXQoY29tbWVudElkLCAiL2F3YXJkX2Vtb2ppIiksIHsKICAgICAgICAgICAgICAgICAgbmFtZTogbWFwUmVhY3Rpb25OYW1lKHJlYWN0aW9uKQogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogIkJlYXJlciAiLmNvbmNhdChhY2Nlc3NUb2tlbikKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gX2NvbnRleHQxMi5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuYWJydXB0KCJyZXR1cm4iLCByZXNwb25zZS5zdGF0dXMgPT09IDIwMSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIF9jb250ZXh0MTIucHJldiA9IDg7CiAgICAgICAgICAgICAgICBfY29udGV4dDEyLnQwID0gX2NvbnRleHQxMlsiY2F0Y2giXSgxKTsKCiAgICAgICAgICAgICAgICBpZiAoIShfY29udGV4dDEyLnQwLnJlc3BvbnNlICYmIF9jb250ZXh0MTIudDAucmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTIubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5hYnJ1cHQoInJldHVybiIsIGZhbHNlKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIHRocm93IF9jb250ZXh0MTIudDA7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUxMiwgdGhpcywgW1sxLCA4XV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBwb3N0Q29tbWVudFJlYWN0aW9uKF94OSkgewogICAgICAgIHJldHVybiBfcG9zdENvbW1lbnRSZWFjdGlvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gcG9zdENvbW1lbnRSZWFjdGlvbjsKICAgIH0oKQogICAgLyoqCiAgICAgKiBHZXQgdGhlIHBhcnNlIEhUTUwgb2YgbWFya2Rvd24gY29udGVudAogICAgICoKICAgICAqIEBzZWUgaHR0cHM6Ly9kb2NzLmdpdGxhYi5jb20vY2UvYXBpL21hcmtkb3duLmh0bWwKICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRNYXJrZG93bkNvbnRlbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRNYXJrZG93bkNvbnRlbnQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMyhfcmVmMTMpIHsKICAgICAgICB2YXIgYWNjZXNzVG9rZW4sIGNvbnRlbnRSYXcsIG9wdGlvbnMsIF95aWVsZCR0aGlzJCRodHRwJHBvczMsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTMkKF9jb250ZXh0MTMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMy5wcmV2ID0gX2NvbnRleHQxMy5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gPSBfcmVmMTMuYWNjZXNzVG9rZW4sIGNvbnRlbnRSYXcgPSBfcmVmMTMuY29udGVudFJhdzsKICAgICAgICAgICAgICAgIG9wdGlvbnMgPSB7fTsKCiAgICAgICAgICAgICAgICBpZiAoYWNjZXNzVG9rZW4pIHsKICAgICAgICAgICAgICAgICAgb3B0aW9ucy5oZWFkZXJzID0gewogICAgICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoYWNjZXNzVG9rZW4pCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQxMy5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRodHRwLnBvc3QoIm1hcmtkb3duIiwgewogICAgICAgICAgICAgICAgICB0ZXh0OiBjb250ZW50UmF3LAogICAgICAgICAgICAgICAgICBnZm06IHRydWUKICAgICAgICAgICAgICAgIH0sIG9wdGlvbnMpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBfeWllbGQkdGhpcyQkaHR0cCRwb3MzID0gX2NvbnRleHQxMy5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCR0aGlzJCRodHRwJHBvczMuZGF0YTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLmFicnVwdCgicmV0dXJuIiwgZGF0YS5odG1sKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTMsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRNYXJrZG93bkNvbnRlbnQoX3gxMCkgewogICAgICAgIHJldHVybiBfZ2V0TWFya2Rvd25Db250ZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBnZXRNYXJrZG93bkNvbnRlbnQ7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJwbGF0Zm9ybSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lOiAnR2l0TGFiJywKICAgICAgICBsaW5rOiB0aGlzLmJhc2VVUkwsCiAgICAgICAgdmVyc2lvbjogJ3Y0JywKICAgICAgICBtZXRhOiB7CiAgICAgICAgICByZWFjdGFibGU6IHRydWUsCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICAgIH0KICAgICAgfTsKICAgIH0KICB9XSk7CgogIHJldHVybiBHaXRsYWJWNDsKfSgpOwoKZXhwb3J0IHsgR2l0bGFiVjQgYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import axios from 'axios';\nimport { buildQuery, buildURL, concatURL, getCleanURL, parseQuery, } from '@vssue/utils';\nimport { normalizeUser, normalizeIssue, normalizeComment, normalizeReactions, mapReactionName, } from './utils';\n/**\n * GitLab API V4\n *\n * @see https://docs.gitlab.com/ce/api/\n * @see https://docs.gitlab.com/ce/api/oauth2.html\n */\nexport default class GitlabV4 {\n    constructor({ baseURL = 'https://gitlab.com', owner, repo, labels, clientId, state, }) {\n        this.baseURL = baseURL;\n        this.owner = owner;\n        this.repo = repo;\n        this.labels = labels;\n        this.clientId = clientId;\n        this.state = state;\n        // @see https://docs.gitlab.com/ce/api/README.html#namespaced-path-encoding\n        this._encodedRepo = encodeURIComponent(`${this.owner}/${this.repo}`);\n        this.$http = axios.create({\n            baseURL: concatURL(baseURL, 'api/v4'),\n            headers: {\n                Accept: 'application/json',\n            },\n        });\n    }\n    /**\n     * The platform api info\n     */\n    get platform() {\n        return {\n            name: 'GitLab',\n            link: this.baseURL,\n            version: 'v4',\n            meta: {\n                reactable: true,\n                sortable: true,\n            },\n        };\n    }\n    /**\n     * Redirect to the authorization page of platform.\n     *\n     * @see https://docs.gitlab.com/ce/api/oauth2.html#1-requesting-authorization-code\n     */\n    redirectAuth() {\n        window.location.href = buildURL(concatURL(this.baseURL, 'oauth/authorize'), {\n            client_id: this.clientId,\n            redirect_uri: window.location.href,\n            response_type: 'token',\n            state: this.state,\n        });\n    }\n    /**\n     * Handle authorization.\n     *\n     * @see https://docs.gitlab.com/ce/api/oauth2.html#implicit-grant-flow\n     *\n     * @remarks\n     * If the `access_token` and `state` exist in the query, and the `state` matches, remove them from query, and return the access token.\n     */\n    async handleAuth() {\n        const hash = parseQuery(window.location.hash.slice(1));\n        if (!hash.access_token || hash.state !== this.state) {\n            return null;\n        }\n        const accessToken = hash.access_token;\n        delete hash.access_token;\n        delete hash.token_type;\n        delete hash.expires_in;\n        delete hash.state;\n        const hashString = buildQuery(hash);\n        const newHash = hashString ? `#${hashString}` : '';\n        const replaceURL = `${getCleanURL(window.location.href)}${window.location.search}${newHash}`;\n        window.history.replaceState(null, '', replaceURL);\n        return accessToken;\n    }\n    /**\n     * Get the logged-in user with access token.\n     */\n    async getUser({ accessToken, }) {\n        const { data } = await this.$http.get('user', {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return normalizeUser(data);\n    }\n    /**\n     * Get issue of this page according to the issue id or the issue title\n     *\n     * @see https://docs.gitlab.com/ce/api/issues.html#single-issue\n     * @see https://docs.gitlab.com/ce/api/issues.html#list-issues\n     * @see https://docs.gitlab.com/ce/api/README.html#pagination\n     */\n    async getIssue({ accessToken, issueId, issueTitle, }) {\n        const options = {};\n        if (accessToken) {\n            options.headers = {\n                Authorization: `Bearer ${accessToken}`,\n            };\n        }\n        if (issueId) {\n            try {\n                const { data } = await this.$http.get(`projects/${this._encodedRepo}/issues/${issueId}`, options);\n                return normalizeIssue(data);\n            }\n            catch (e) {\n                if (e.response && e.response.status === 404) {\n                    return null;\n                }\n                else {\n                    throw e;\n                }\n            }\n        }\n        else {\n            options.params = {\n                labels: this.labels.join(','),\n                order_by: 'created_at',\n                sort: 'asc',\n                search: issueTitle,\n            };\n            const { data } = await this.$http.get(`projects/${this._encodedRepo}/issues`, options);\n            const issue = data\n                .map(normalizeIssue)\n                .find(item => item.title === issueTitle);\n            return issue || null;\n        }\n    }\n    /**\n     * Create a new issue\n     *\n     * @see https://docs.gitlab.com/ce/api/issues.html#new-issue\n     */\n    async postIssue({ accessToken, title, content, }) {\n        const { data } = await this.$http.post(`projects/${this._encodedRepo}/issues`, {\n            title,\n            description: content,\n            labels: this.labels.join(','),\n        }, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return normalizeIssue(data);\n    }\n    /**\n     * Get comments of this page according to the issue id\n     *\n     * @see https://docs.gitlab.com/ce/api/notes.html#list-project-issue-notes\n     * @see https://docs.gitlab.com/ce/api/README.html#pagination\n     *\n     * @remarks\n     * Cannot get the HTML content and the reactions (award_emoji) here.\n     * So have to request them via `markdown` and `award_emoji` API.\n     */\n    async getComments({ accessToken, issueId, query: { page = 1, perPage = 10, sort = 'desc' } = {}, }) {\n        const options = {\n            params: {\n                // pagination\n                page: page,\n                per_page: perPage,\n                order_by: 'created_at',\n                sort: sort,\n            },\n        };\n        if (accessToken) {\n            options.headers = {\n                Authorization: `Bearer ${accessToken}`,\n            };\n        }\n        const response = await this.$http.get(`projects/${this._encodedRepo}/issues/${issueId}/notes`, options);\n        const commentsRaw = response.data;\n        // gitlab api v4 should get parsed markdown content and reactions by other api\n        // this is potentially to cause 429 Too Many Requests\n        const getCommentsMeta = [];\n        for (const comment of commentsRaw) {\n            getCommentsMeta.push((async () => {\n                comment.body_html = await this.getMarkdownContent({\n                    accessToken: accessToken,\n                    contentRaw: comment.body,\n                });\n            })());\n            getCommentsMeta.push((async () => {\n                comment.reactions = await this.getCommentReactions({\n                    accessToken: accessToken,\n                    issueId: issueId,\n                    commentId: comment.id,\n                });\n            })());\n        }\n        await Promise.all(getCommentsMeta);\n        return {\n            count: Number(response.headers['x-total']),\n            page: Number(response.headers['x-page']),\n            perPage: Number(response.headers['x-per-page']),\n            data: commentsRaw.map(normalizeComment),\n        };\n    }\n    /**\n     * Create a new comment\n     *\n     * @see https://docs.gitlab.com/ce/api/notes.html#create-new-issue-note\n     */\n    async postComment({ accessToken, issueId, content, }) {\n        const { data } = await this.$http.post(`projects/${this._encodedRepo}/issues/${issueId}/notes`, {\n            body: content,\n        }, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return normalizeComment(data);\n    }\n    /**\n     * Edit a comment\n     *\n     * @see https://docs.gitlab.com/ce/api/notes.html#modify-existing-issue-note\n     */\n    async putComment({ accessToken, issueId, commentId, content, }) {\n        const { data } = await this.$http.put(`projects/${this._encodedRepo}/issues/${issueId}/notes/${commentId}`, {\n            body: content,\n        }, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        const [contentHTML, reactions] = await Promise.all([\n            this.getMarkdownContent({\n                accessToken: accessToken,\n                contentRaw: data.body,\n            }),\n            this.getCommentReactions({\n                accessToken: accessToken,\n                issueId: issueId,\n                commentId: data.id,\n            }),\n        ]);\n        data.body_html = contentHTML;\n        data.reactions = reactions;\n        return normalizeComment(data);\n    }\n    /**\n     * Delete a comment\n     *\n     * @see https://docs.gitlab.com/ce/api/notes.html#delete-an-issue-note\n     */\n    async deleteComment({ accessToken, issueId, commentId, }) {\n        const { status } = await this.$http.delete(`projects/${this._encodedRepo}/issues/${issueId}/notes/${commentId}`, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return status === 204;\n    }\n    /**\n     * Get reactions of a comment\n     *\n     * @see https://docs.gitlab.com/ce/api/award_emoji.html#list-an-awardables-award-emoji\n     */\n    async getCommentReactions({ accessToken, issueId, commentId, }) {\n        const { data } = await this.$http.get(`projects/${this._encodedRepo}/issues/${issueId}/notes/${commentId}/award_emoji`, {\n            headers: { Authorization: `Bearer ${accessToken}` },\n        });\n        return normalizeReactions(data);\n    }\n    /**\n     * Create a new reaction of a comment\n     *\n     * @see https://docs.gitlab.com/ce/api/award_emoji.html#award-a-new-emoji\n     */\n    async postCommentReaction({ issueId, commentId, reaction, accessToken, }) {\n        try {\n            const response = await this.$http.post(`projects/${this._encodedRepo}/issues/${issueId}/notes/${commentId}/award_emoji`, {\n                name: mapReactionName(reaction),\n            }, {\n                headers: {\n                    Authorization: `Bearer ${accessToken}`,\n                },\n            });\n            return response.status === 201;\n        }\n        catch (e) {\n            // it could be a bug of gitlab\n            // if a reaction (award emoji) has already existed, it returns a 404 response with a buggy message\n            // have submitted an issue: https://gitlab.com/gitlab-org/gitlab-ce/issues/56147\n            /* istanbul ignore next */\n            if (e.response && e.response.status === 404) {\n                return false;\n            }\n            else {\n                throw e;\n            }\n        }\n    }\n    /**\n     * Get the parse HTML of markdown content\n     *\n     * @see https://docs.gitlab.com/ce/api/markdown.html\n     */\n    async getMarkdownContent({ accessToken, contentRaw, }) {\n        const options = {};\n        if (accessToken) {\n            options.headers = {\n                Authorization: `Bearer ${accessToken}`,\n            };\n        }\n        const { data } = await this.$http.post(`markdown`, {\n            text: contentRaw,\n            gfm: true,\n        }, options);\n        return data.html;\n    }\n}\n//# sourceMappingURL=index.js.map"]}]}